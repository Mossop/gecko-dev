# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this file,
# You can obtain one at http://mozilla.org/MPL/2.0/.

include $(topsrcdir)/config/config.mk

include $(topsrcdir)/config/rules.mk

DUMP_SYMBOLS_FLAGS = --count-ctors

ifdef CLANG_CL
ifdef MOZ_PROFILE_USE
ifeq (x86,$(CPU_ARCH))
PGO_LDFLAGS += -ORDER:@$(topsrcdir)/build/win32/orderfile.txt
endif
ifeq (x86_64,$(CPU_ARCH))
PGO_LDFLAGS += -ORDER:@$(topsrcdir)/build/win64/orderfile.txt
endif
endif
endif

ifeq (cocoa,$(MOZ_WIDGET_TOOLKIT))
libs:: XUL
	install_name_tool -change @executable_path/libmozglue.dylib @loader_path/libmozglue.dylib \
	                  -change @executable_path/libnss3.dylib @loader_path/libnss3.dylib \
	                  -change @executable_path/liblgpllibs.dylib @loader_path/liblgpllibs.dylib \
	                  XUL
endif
